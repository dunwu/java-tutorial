(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{484:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"shiro-å¿«é€Ÿå…¥é—¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shiro-å¿«é€Ÿå…¥é—¨"}},[t._v("#")]),t._v(" Shiro å¿«é€Ÿå…¥é—¨")]),t._v(" "),a("blockquote",[a("p",[t._v("Shiro æ˜¯ä¸€ä¸ªå®‰å…¨æ¡†æ¶ï¼Œå…·æœ‰è®¤è¯ã€æˆæƒã€åŠ å¯†ã€ä¼šè¯ç®¡ç†åŠŸèƒ½ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"ä¸€ã€shiro-ç®€ä»‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€shiro-ç®€ä»‹"}},[t._v("#")]),t._v(" ä¸€ã€Shiro ç®€ä»‹")]),t._v(" "),a("h3",{attrs:{id:"shiro-ç‰¹æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shiro-ç‰¹æ€§"}},[t._v("#")]),t._v(" Shiro ç‰¹æ€§")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javaweb/standalone/security/shiro/shiro-features.png"}})]),t._v(" "),a("p",[t._v("æ ¸å¿ƒåŠŸèƒ½ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Authentication")]),t._v(" - "),a("strong",[t._v("è®¤è¯")]),t._v("ã€‚éªŒè¯ç”¨æˆ·æ˜¯ä¸æ˜¯æ‹¥æœ‰ç›¸åº”çš„èº«ä»½ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("Authorization")]),t._v(" - "),a("strong",[t._v("æˆæƒ")]),t._v("ã€‚éªŒè¯æŸä¸ªå·²è®¤è¯çš„ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªæƒé™ï¼›å³åˆ¤æ–­ç”¨æˆ·æ˜¯å¦èƒ½åšäº‹æƒ…ï¼Œå¸¸è§çš„å¦‚ï¼šéªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æŸä¸ªè§’è‰²ã€‚æˆ–è€…ç»†ç²’åº¦çš„éªŒè¯æŸä¸ªç”¨æˆ·å¯¹æŸä¸ªèµ„æºæ˜¯å¦å…·æœ‰æŸä¸ªæƒé™ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("Session Manager")]),t._v(" - "),a("strong",[t._v("ä¼šè¯ç®¡ç†")]),t._v("ã€‚å³ç”¨æˆ·ç™»å½•åå°±æ˜¯ä¸€æ¬¡ä¼šè¯ï¼Œåœ¨æ²¡æœ‰é€€å‡ºä¹‹å‰ï¼Œå®ƒçš„æ‰€æœ‰ä¿¡æ¯éƒ½åœ¨ä¼šè¯ä¸­ã€‚ä¼šè¯å¯ä»¥æ˜¯æ™®é€š JavaSE ç¯å¢ƒçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦‚ Web ç¯å¢ƒçš„ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("Cryptography")]),t._v(" - "),a("strong",[t._v("åŠ å¯†")]),t._v("ã€‚ä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§ï¼Œå¦‚å¯†ç åŠ å¯†å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œè€Œä¸æ˜¯æ˜æ–‡å­˜å‚¨ã€‚")])]),t._v(" "),a("p",[t._v("è¾…åŠ©åŠŸèƒ½ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Web Support")]),t._v(" - "),a("strong",[t._v("Web æ”¯æŒ")]),t._v("ã€‚å¯ä»¥éå¸¸å®¹æ˜“çš„é›†æˆåˆ° Web ç¯å¢ƒï¼›")]),t._v(" "),a("li",[a("strong",[t._v("Caching")]),t._v(" - "),a("strong",[t._v("ç¼“å­˜")]),t._v("ã€‚æ¯”å¦‚ç”¨æˆ·ç™»å½•åï¼Œå…¶ç”¨æˆ·ä¿¡æ¯ã€æ‹¥æœ‰çš„è§’è‰² / æƒé™ä¸å¿…æ¯æ¬¡å»æŸ¥ï¼Œè¿™æ ·å¯ä»¥æé«˜æ•ˆç‡ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("Concurrency")]),t._v(" - "),a("strong",[t._v("å¹¶å‘")]),t._v("ã€‚Shiro æ”¯æŒå¤šçº¿ç¨‹åº”ç”¨çš„å¹¶å‘éªŒè¯ï¼Œå³å¦‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å¼€å¯å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œèƒ½æŠŠæƒé™è‡ªåŠ¨ä¼ æ’­è¿‡å»ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("Testing")]),t._v(" - "),a("strong",[t._v("æµ‹è¯•")]),t._v("ã€‚æä¾›æµ‹è¯•æ”¯æŒï¼›")]),t._v(" "),a("li",[a("strong",[t._v("Run As")]),t._v(" - "),a("strong",[t._v("è¿è¡Œæ–¹å¼")]),t._v("ã€‚å…è®¸ä¸€ä¸ªç”¨æˆ·å‡è£…ä¸ºå¦ä¸€ä¸ªç”¨æˆ·ï¼ˆå¦‚æœä»–ä»¬å…è®¸ï¼‰çš„èº«ä»½è¿›è¡Œè®¿é—®ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("Remember Me")]),t._v(" - "),a("strong",[t._v("è®°ä½æˆ‘")]),t._v("ã€‚å³ä¸€æ¬¡ç™»å½•åï¼Œä¸‹æ¬¡å†è®¿é—®å…ç™»å½•ã€‚")])]),t._v(" "),a("blockquote",[a("p",[t._v("ğŸ”” æ³¨æ„ï¼šShiro ä¸ä¼šå»ç»´æŠ¤ç”¨æˆ·ã€ç»´æŠ¤æƒé™ï¼›è¿™äº›éœ€è¦æˆ‘ä»¬è‡ªå·±å»æä¾›ï¼›ç„¶åé€šè¿‡ç›¸åº”çš„æ¥å£æ³¨å…¥ç»™ Shiro å³å¯ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"shiro-æ¶æ„æ¦‚è¿°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shiro-æ¶æ„æ¦‚è¿°"}},[t._v("#")]),t._v(" Shiro æ¶æ„æ¦‚è¿°")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javaweb/standalone/security/shiro/ShiroBasicArchitecture.png"}})]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("Subject")]),t._v(" - "),a("strong",[t._v("ä¸»é¢˜")]),t._v("ã€‚å®ƒä»£è¡¨å½“å‰ç”¨æˆ·ï¼Œ"),a("code",[t._v("Subject")]),t._v(" å¯ä»¥æ˜¯ä¸€ä¸ªäººï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯ç¬¬ä¸‰æ–¹æœåŠ¡ã€å®ˆæŠ¤è¿›ç¨‹å¸æˆ·ã€æ—¶é’Ÿå®ˆæŠ¤ä»»åŠ¡æˆ–è€…å…¶å®ƒâ€”â€”å½“å‰å’Œè½¯ä»¶äº¤äº’çš„ä»»ä½•äº‹ä»¶ã€‚"),a("code",[t._v("Subject")]),t._v(" æ˜¯ Shiro çš„å…¥å£ã€‚")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Principals")]),t._v(" æ˜¯ "),a("code",[t._v("Subject")]),t._v(" çš„â€œè¯†åˆ«å±æ€§â€ã€‚"),a("code",[t._v("Principals")]),t._v(" å¯ä»¥æ˜¯ä»»ä½•å¯ä»¥è¯†åˆ« "),a("code",[t._v("Subject")]),t._v(" çš„ä¸œè¥¿ï¼Œä¾‹å¦‚åå­—ï¼ˆå§“æ°ï¼‰ï¼Œå§“æ°ï¼ˆå§“æ°æˆ–å§“æ°ï¼‰ï¼Œç”¨æˆ·åï¼Œç¤¾ä¼šä¿é™©å·ç­‰ã€‚å½“ç„¶ï¼Œ"),a("code",[t._v("Principals")]),t._v(" åœ¨åº”ç”¨ç¨‹åºä¸­æœ€å¥½æ˜¯æƒŸä¸€çš„ã€‚")]),t._v(" "),a("li",[a("code",[t._v("Credentials")]),t._v(" é€šå¸¸æ˜¯ä»…ç”± "),a("code",[t._v("Subject")]),t._v(" çŸ¥é“çš„ç§˜å¯†å€¼ï¼Œç”¨ä½œä»–ä»¬å®é™…ä¸Šâ€œæ‹¥æœ‰â€æ‰€ä¸»å¼ èº«ä»½çš„ä½è¯ å‡­æ®çš„ä¸€äº›å¸¸è§ç¤ºä¾‹æ˜¯å¯†ç ï¼Œç”Ÿç‰©ç‰¹å¾æ•°æ®ï¼ˆä¾‹å¦‚æŒ‡çº¹å’Œè§†ç½‘è†œæ‰«æï¼‰ä»¥åŠ X.509 è¯ä¹¦ã€‚")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("SecurityManager")]),t._v(" - "),a("strong",[t._v("å®‰å…¨ç®¡ç†")]),t._v("ã€‚å®ƒæ˜¯ Shiro çš„æ ¸å¿ƒï¼Œæ‰€æœ‰ä¸å®‰å…¨æœ‰å…³çš„æ“ä½œï¼ˆè®¤è¯ã€æˆæƒã€åŠä¼šè¯ã€ç¼“å­˜çš„ç®¡ç†ï¼‰éƒ½ä¸ "),a("code",[t._v("SecurityManager")]),t._v(" äº¤äº’ï¼Œä¸”å®ƒç®¡ç†ç€æ‰€æœ‰ "),a("code",[t._v("Subject")]),t._v("ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Realm")]),t._v(" - "),a("strong",[t._v("åŸŸ")]),t._v("ã€‚ç”¨äºè®¿é—®å®‰å…¨ç›¸å…³æ•°æ®ï¼Œå¯ä»¥è§†ä¸ºåº”ç”¨è‡ªèº«çš„æ•°æ®æºï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±å®ç°ã€‚Shiro ä¼šé€šè¿‡ "),a("code",[t._v("Realm")]),t._v(" è·å–å®‰å…¨æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰ï¼Œå°±æ˜¯è¯´ "),a("code",[t._v("SecurityManager")]),t._v(" è¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå®ƒéœ€è¦ä» "),a("code",[t._v("Realm")]),t._v(" è·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒä»¥ç¡®å®šç”¨æˆ·èº«ä»½æ˜¯å¦åˆæ³•ï¼›ä¹Ÿéœ€è¦ä» Realm å¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰²/æƒé™è¿›è¡ŒéªŒè¯ç”¨æˆ·æ˜¯å¦èƒ½è¿›è¡Œæ“ä½œï¼›å¯ä»¥æŠŠ "),a("code",[t._v("Realm")]),t._v(" çœ‹æˆ DataSourceï¼Œå³å®‰å…¨æ•°æ®æºã€‚")])])]),t._v(" "),a("h3",{attrs:{id:"securitymanager"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#securitymanager"}},[t._v("#")]),t._v(" SecurityManager")]),t._v(" "),a("p",[a("code",[t._v("SecurityManager")]),t._v(" æ˜¯ Shiro æ¡†æ¶æ ¸å¿ƒä¸­çš„æ ¸å¿ƒï¼Œå®ƒç›¸å½“äº Shiro çš„æ€»æŒ‡æŒ¥ï¼Œè´Ÿè´£è°ƒåº¦æ‰€æœ‰è¡Œä¸ºï¼ŒåŒ…æ‹¬ï¼šè®¤è¯ã€æˆæƒã€è·å–å®‰å…¨æ•°æ®ï¼ˆè°ƒç”¨ "),a("code",[t._v("Realm")]),t._v("ï¼‰ã€ä¼šè¯ç®¡ç†ç­‰ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javaweb/standalone/security/shiro/ShiroArchitecture.png",alt:"img"}})]),t._v(" "),a("p",[a("code",[t._v("SecurityManager")]),t._v(" èšåˆäº†ä»¥ä¸‹ç»„ä»¶ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Authenticator")]),t._v(" - è®¤è¯å™¨ï¼Œè´Ÿè´£è®¤è¯ã€‚å¦‚æœç”¨æˆ·éœ€è¦å®šåˆ¶è®¤è¯ç­–ç•¥ï¼Œå¯ä»¥å®ç°æ­¤æ¥å£ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("Authorizer")]),t._v(" - æˆæƒå™¨ï¼Œè´Ÿè´£æƒé™æ§åˆ¶ã€‚ç”¨æ¥å†³å®šä¸»ä½“æ˜¯å¦æœ‰æƒé™è¿›è¡Œç›¸åº”çš„æ“ä½œï¼›å³æ§åˆ¶ç€ç”¨æˆ·èƒ½è®¿é—®åº”ç”¨ä¸­çš„å“ªäº›åŠŸèƒ½ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("SessionManager")]),t._v(" - ä¼šè¯ç®¡ç†å™¨ã€‚Shiro æŠ½è±¡äº†ä¸€ä¸ªè‡ªå·±çš„ Session æ¥ç®¡ç†ä¸»ä½“ä¸åº”ç”¨ä¹‹é—´äº¤äº’çš„æ•°æ®ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("SessionDAO")]),t._v(" - ä¼šè¯ DAO ç”¨äºå­˜å‚¨ä¼šè¯ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±å®ç°ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("CacheManager")]),t._v(" - ç¼“å­˜æ§åˆ¶å™¨ã€‚ç”¨äºç®¡ç†å¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ç­‰ä¿¡æ¯çš„ç¼“å­˜ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("Cryptography")]),t._v(" - å¯†ç å™¨ã€‚ç”¨äºå¯¹æ•°æ®åŠ å¯†ã€è§£å¯†ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"äºŒã€shiro-è®¤è¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€shiro-è®¤è¯"}},[t._v("#")]),t._v(" äºŒã€Shiro è®¤è¯")]),t._v(" "),a("h3",{attrs:{id:"è®¤è¯-subject"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¤è¯-subject"}},[t._v("#")]),t._v(" è®¤è¯ Subject")]),t._v(" "),a("p",[t._v("éªŒè¯ Subject çš„è¿‡ç¨‹å¯ä»¥æœ‰æ•ˆåœ°åˆ†ä¸ºä¸‰ä¸ªä¸åŒçš„æ­¥éª¤ï¼š")]),t._v(" "),a("p",[t._v("ï¼ˆ1ï¼‰æ”¶é›† "),a("code",[t._v("Subject")]),t._v(" æäº¤çš„ "),a("code",[t._v("Principals")]),t._v(" å’Œ "),a("code",[t._v("Credentials")])]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Example using most common scenario of username/password pair:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsernamePasswordToken")]),t._v(" token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsernamePasswordToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//"Remember Me" built-in:')]),t._v("\ntoken"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRememberMe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("ï¼ˆ2ï¼‰æäº¤ "),a("code",[t._v("Principals")]),t._v(" å’Œ "),a("code",[t._v("Credentials")]),t._v(" ä»¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Subject")]),t._v(" currentUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecurityUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSubject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\ncurrentUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("login")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("ï¼ˆ3ï¼‰å¦‚æœæäº¤æˆåŠŸï¼Œåˆ™å…è®¸è®¿é—®ï¼Œå¦åˆ™é‡è¯•èº«ä»½éªŒè¯æˆ–é˜»æ­¢è®¿é—®ã€‚")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    currentUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("login")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UnknownAccountException")]),t._v(" uae "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IncorrectCredentialsException")]),t._v(" ice "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LockedAccountException")]),t._v(" lae "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExcessiveAttemptsException")]),t._v(" eae "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" your own "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AuthenticationException")]),t._v(" ae "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//unexpected error?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"remembered-å’Œ-authenticated"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remembered-å’Œ-authenticated"}},[t._v("#")]),t._v(" Remembered å’Œ Authenticated")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("Remembered")]),t._v(" - è®°ä½æˆ‘ã€‚è¢«è®°ä½çš„ "),a("code",[t._v("Subject")]),t._v(" ä¸æ˜¯åŒ¿åçš„ï¼Œå¹¶ä¸”å…·æœ‰å·²çŸ¥çš„èº«ä»½ï¼ˆå³ "),a("code",[t._v("subject.getPrincipals()")]),t._v(" æ˜¯éç©ºçš„ï¼‰ã€‚ ä½†æ˜¯ï¼Œåœ¨å…ˆå‰çš„ä¼šè¯æœŸé—´ï¼Œé€šè¿‡å…ˆå‰çš„èº«ä»½éªŒè¯ä¼šè®°ä½æ­¤èº«ä»½ã€‚ å¦‚æœ "),a("code",[t._v("subject.isRemembered()")]),t._v(" è¿”å› "),a("code",[t._v("true")]),t._v("ï¼Œåˆ™è®¤ä¸ºè¯¥ä¸»é¢˜å·²è¢«è®°ä½ã€‚")]),t._v(" "),a("li",[a("code",[t._v("Authenticated")]),t._v(" - å·²è®¤è¯ã€‚å·²è®¤è¯çš„ "),a("code",[t._v("Subject")]),t._v(" æ˜¯åœ¨å½“å‰ä¼šè¯æœŸé—´å·²æˆåŠŸè®¤è¯çš„ "),a("code",[t._v("Subject")]),t._v("ã€‚ å¦‚æœ "),a("code",[t._v("subject.isAuthenticated()")]),t._v(" è¿”å› "),a("code",[t._v("true")]),t._v("ï¼Œåˆ™è®¤ä¸ºè¯¥ "),a("code",[t._v("Subject")]),t._v(" å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"ç™»å‡º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç™»å‡º"}},[t._v("#")]),t._v(" ç™»å‡º")]),t._v(" "),a("p",[t._v("å½“ Subject ä¸åº”ç”¨ç¨‹åºå®Œæˆäº¤äº’åï¼Œå¯ä»¥è°ƒç”¨ "),a("code",[t._v("subject.logout()")]),t._v(" ç™»å‡ºï¼Œå³æ”¾å¼ƒæ‰€æœ‰æ ‡è¯†ä¿¡æ¯ã€‚")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("currentUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("logout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"è®¤è¯æµç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¤è¯æµç¨‹"}},[t._v("#")]),t._v(" è®¤è¯æµç¨‹")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/snap/20200317092427.png",alt:"img"}})]),t._v(" "),a("ol",[a("li",[a("p",[t._v("åº”ç”¨ç¨‹åºä»£ç è°ƒç”¨ "),a("code",[t._v("Subject.login")]),t._v(" æ–¹æ³•ï¼Œä¼ å…¥æ„é€ çš„ "),a("code",[t._v("AuthenticationToken")]),t._v(" å®ä¾‹ï¼Œè¯¥å®ä¾‹ä»£è¡¨æœ€ç»ˆç”¨æˆ·çš„ "),a("code",[t._v("Principals")]),t._v(" å’Œ "),a("code",[t._v("Credentials")]),t._v("ã€‚")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Subject")]),t._v(" å®ä¾‹ï¼ˆé€šå¸¸æ˜¯ "),a("code",[t._v("DelegatingSubject")]),t._v("ï¼ˆæˆ–å­ç±»ï¼‰ï¼‰é€šè¿‡è°ƒç”¨ "),a("code",[t._v("securityManager.login")]),t._v("ï¼ˆtokenï¼‰å§”æ‰˜åº”ç”¨ç¨‹åºçš„ "),a("code",[t._v("SecurityManager")]),t._v("ï¼Œåœ¨æ­¤å¤„å¼€å§‹å®é™…çš„èº«ä»½éªŒè¯å·¥ä½œã€‚")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("SecurityManager")]),t._v(" æ¥æ”¶ä»¤ç‰Œï¼Œå¹¶é€šè¿‡è°ƒç”¨ "),a("code",[t._v("authenticator.authenticate")]),t._v("ï¼ˆtokenï¼‰æ¥ç®€å•åœ°å§”æ´¾ç»™å…¶å†…éƒ¨ "),a("code",[t._v("Authenticator")]),t._v(" å®ä¾‹ã€‚è¿™å‡ ä¹æ€»æ˜¯ä¸€ä¸ª "),a("code",[t._v("ModularRealmAuthenticator")]),t._v(" å®ä¾‹ï¼Œå®ƒæ”¯æŒåœ¨èº«ä»½éªŒè¯æœŸé—´åè°ƒä¸€ä¸ªæˆ–å¤šä¸ª "),a("code",[t._v("Realm")]),t._v(" å®ä¾‹ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("å¦‚æœä¸ºè¯¥åº”ç”¨ç¨‹åºé…ç½®äº†å¤šä¸ª "),a("code",[t._v("Realm")]),t._v("ï¼Œåˆ™ "),a("code",[t._v("ModularRealmAuthenticator")]),t._v(" å®ä¾‹å°†åˆ©ç”¨å…¶é…ç½®çš„ "),a("code",[t._v("AuthenticationStrategy")]),t._v(" å‘èµ·å¤šåŸŸéªŒè¯å°è¯•ã€‚åœ¨è°ƒç”¨é¢†åŸŸè¿›è¡Œèº«ä»½éªŒè¯ä¹‹å‰ï¼ŒæœŸé—´å’Œä¹‹åï¼Œå°†è°ƒç”¨ "),a("code",[t._v("AuthenticationStrategy")]),t._v(" ä»¥ä½¿å…¶å¯¹æ¯ä¸ªé¢†åŸŸçš„ç»“æœåšå‡ºååº”ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("è¯·å’¨è¯¢æ¯ä¸ªå·²é…ç½®çš„ "),a("code",[t._v("Realm")]),t._v("ï¼Œä»¥æŸ¥çœ‹å…¶æ˜¯å¦æ”¯æŒæäº¤çš„ "),a("code",[t._v("AuthenticationToken")]),t._v("ã€‚ å¦‚æœæ˜¯è¿™æ ·ï¼Œå°†ä½¿ç”¨æäº¤çš„ä»¤ç‰Œè°ƒç”¨æ”¯æŒ "),a("code",[t._v("Realm")]),t._v(" çš„ "),a("code",[t._v("getAuthenticationInfo")]),t._v(" æ–¹æ³•ã€‚ "),a("code",[t._v("getAuthenticationInfo")]),t._v(" æ–¹æ³•æœ‰æ•ˆåœ°è¡¨ç¤ºå¯¹è¯¥ç‰¹å®š "),a("code",[t._v("Realm")]),t._v(" çš„å•ä¸ªèº«ä»½éªŒè¯å°è¯•ã€‚")])])]),t._v(" "),a("h3",{attrs:{id:"è®¤è¯ç­–ç•¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¤è¯ç­–ç•¥"}},[t._v("#")]),t._v(" è®¤è¯ç­–ç•¥")]),t._v(" "),a("p",[t._v("å½“ä¸ºä¸€ä¸ªåº”ç”¨ç¨‹åºé…ç½®ä¸¤ä¸ªæˆ–å¤šä¸ªé¢†åŸŸæ—¶ï¼Œ"),a("code",[t._v("ModularRealmAuthenticator")]),t._v(" ä¾èµ–äºå†…éƒ¨ "),a("code",[t._v("AuthenticationStrategy")]),t._v(" ç»„ä»¶æ¥ç¡®å®šè®¤è¯å°è¯•æˆåŠŸæˆ–å¤±è´¥çš„æ¡ä»¶ã€‚")]),t._v(" "),a("p",[t._v("ä¾‹å¦‚ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ª Realm æˆåŠŸåœ°å¯¹ AuthenticationToken è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè€Œæ‰€æœ‰å…¶ä»– Realm éƒ½å¤±è´¥äº†ï¼Œé‚£ä¹ˆè¯¥èº«ä»½éªŒè¯å°è¯•æ˜¯å¦è¢«è§†ä¸ºæˆåŠŸï¼Ÿè¿˜æ˜¯å¿…é¡»æ‰€æœ‰é¢†åŸŸéƒ½æˆåŠŸè¿›è¡Œèº«ä»½éªŒè¯æ‰èƒ½å°†æ•´ä½“å°è¯•è§†ä¸ºæˆåŠŸï¼Ÿæˆ–è€…ï¼Œå¦‚æœæŸä¸ªé¢†åŸŸæˆåŠŸé€šè¿‡èº«ä»½éªŒè¯ï¼Œæ˜¯å¦æœ‰å¿…è¦è¿›ä¸€æ­¥å’¨è¯¢å…¶ä»–é¢†åŸŸï¼Ÿ AuthenticationStrategy æ ¹æ®åº”ç”¨ç¨‹åºçš„éœ€æ±‚åšå‡ºé€‚å½“çš„å†³å®šã€‚")]),t._v(" "),a("p",[a("code",[t._v("AuthenticationStrategy")]),t._v(" æ˜¯æ— çŠ¶æ€ç»„ä»¶ï¼Œåœ¨å°è¯•è¿›è¡Œèº«ä»½éªŒè¯æ—¶ä¼šè¢«æŸ¥è¯¢ 4 æ¬¡ï¼ˆè¿™ 4 ç§äº¤äº’æ‰€éœ€çš„ä»»ä½•å¿…è¦çŠ¶æ€éƒ½å°†ä½œä¸ºæ–¹æ³•å‚æ•°ç»™å‡ºï¼‰ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("åœ¨ä»»ä½•é¢†åŸŸè¢«è°ƒç”¨ä¹‹å‰")]),t._v(" "),a("li",[t._v("åœ¨è°ƒç”¨å•ä¸ª "),a("code",[t._v("Realm")]),t._v(" çš„ "),a("code",[t._v("getAuthenticationInfo")]),t._v(" æ–¹æ³•ä¹‹å‰")]),t._v(" "),a("li",[t._v("åœ¨è°ƒç”¨å•ä¸ª "),a("code",[t._v("Realm")]),t._v(" çš„ "),a("code",[t._v("getAuthenticationInfo")]),t._v(" æ–¹æ³•ä¹‹å")]),t._v(" "),a("li",[t._v("åœ¨æ‰€æœ‰é¢†åŸŸéƒ½è¢«è°ƒç”¨ä¹‹å")])]),t._v(" "),a("p",[a("code",[t._v("AuthenticationStrategy")]),t._v(" è¿˜è´Ÿè´£æ±‡æ€»æ¯ä¸ªæˆåŠŸ "),a("code",[t._v("Realm")]),t._v(" çš„ç»“æœï¼Œå¹¶å°†å®ƒä»¬â€œæ†ç»‘â€æˆå•ä¸ª "),a("code",[t._v("AuthenticationInfo")]),t._v(" è¡¨ç¤ºå½¢å¼ã€‚æœ€ç»ˆçš„èšåˆ "),a("code",[t._v("AuthenticationInfo")]),t._v(" å®ä¾‹æ˜¯ "),a("code",[t._v("Authenticator")]),t._v(" å®ä¾‹è¿”å›çš„ç»“æœï¼Œä¹Ÿæ˜¯ Shiro ç”¨æ¥è¡¨ç¤ºä¸»ä½“çš„æœ€ç»ˆèº«ä»½ï¼ˆä¹Ÿç§°ä¸ºå§”æ‰˜äººï¼‰çš„ä¸œè¥¿ã€‚")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[a("code",[t._v("AuthenticationStrategy")])]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("æè¿°")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authc/pam/AtLeastOneSuccessfulStrategy.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("AtLeastOneSuccessfulStrategy")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("åªè¦æœ‰ä¸€ä¸ª "),a("code",[t._v("Realm")]),t._v(" æˆåŠŸè®¤è¯ï¼Œåˆ™æ•´ä¸ªå°è¯•éƒ½è¢«è§†ä¸ºæˆåŠŸã€‚")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authc/pam/FirstSuccessfulStrategy.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("FirstSuccessfulStrategy")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("ä»…ä½¿ç”¨ä»ç¬¬ä¸€ä¸ªæˆåŠŸé€šè¿‡èº«ä»½éªŒè¯çš„ "),a("code",[t._v("Realm")]),t._v(" è¿”å›çš„ä¿¡æ¯ï¼Œæ‰€æœ‰å…¶ä»– Realm å°†è¢«å¿½ç•¥ã€‚")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authc/pam/AllSuccessfulStrategy.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("AllSuccessfulStrategy")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("åªæœ‰æ‰€æœ‰ "),a("code",[t._v("Realm")]),t._v(" æˆåŠŸè®¤è¯ï¼Œåˆ™æ•´ä¸ªå°è¯•æ‰è¢«è§†ä¸ºæˆåŠŸã€‚")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("ğŸ”— æ›´å¤šè®¤è¯ç»†èŠ‚å¯ä»¥å‚è€ƒï¼š"),a("a",{attrs:{href:"http://shiro.apache.org/authentication.html#apache-shiro-authentication",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache Shiro Authentication"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"ä¸‰ã€shiro-æˆæƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€shiro-æˆæƒ"}},[t._v("#")]),t._v(" ä¸‰ã€Shiro æˆæƒ")]),t._v(" "),a("p",[t._v("æˆæƒï¼Œä¹Ÿç§°ä¸ºè®¿é—®æ§åˆ¶ï¼Œæ˜¯ç®¡ç†å¯¹èµ„æºçš„è®¿é—®çš„è¿‡ç¨‹ã€‚ æ¢å¥è¯è¯´ï¼Œæ§åˆ¶è°æœ‰æƒè®¿é—®åº”ç”¨ç¨‹åºä¸­çš„å†…å®¹ã€‚")]),t._v(" "),a("h3",{attrs:{id:"æˆæƒå…ƒç´ "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æˆæƒå…ƒç´ "}},[t._v("#")]),t._v(" æˆæƒå…ƒç´ ")]),t._v(" "),a("p",[t._v("æˆæƒæœ‰ä¸‰ä¸ªæ ¸å¿ƒè¦ç´ ï¼šæƒé™ã€è§’è‰²å’Œç”¨æˆ·ã€‚")]),t._v(" "),a("h4",{attrs:{id:"æƒé™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æƒé™"}},[t._v("#")]),t._v(" æƒé™")]),t._v(" "),a("p",[t._v("æƒé™ç¤ºä¾‹ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶")]),t._v(" "),a("li",[t._v("æŸ¥çœ‹ "),a("code",[t._v("/user/list")]),t._v(" web é¡µé¢")]),t._v(" "),a("li",[t._v("æŸ¥è¯¢è®°å½•")]),t._v(" "),a("li",[t._v("åˆ é™¤ä¸€æ¡è®°å½•")]),t._v(" "),a("li",[t._v("...")])]),t._v(" "),a("p",[t._v("å¤§å¤šæ•°èµ„æºéƒ½æ”¯æŒä¸€èˆ¬çš„ CRUD æ“ä½œã€‚é™¤æ­¤ä»¥å¤–ï¼Œå¯¹äºä¸€äº›ç‰¹å®šçš„èµ„æºï¼Œä»»ä½•æœ‰æ„ä¹‰çš„è¡Œä¸ºéƒ½æ˜¯å¯ä»¥çš„ã€‚åŸºæœ¬çš„è®¾è®¡æ€è·¯æ˜¯ï¼šæƒé™æ§åˆ¶ï¼Œè‡³å°‘æ˜¯åŸºäºèµ„æºå’Œè¡Œä¸ºã€‚")]),t._v(" "),a("h4",{attrs:{id:"è§’è‰²"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è§’è‰²"}},[t._v("#")]),t._v(" è§’è‰²")]),t._v(" "),a("p",[t._v("è§’è‰²æ˜¯ä¸€ä¸ªå‘½åå®ä½“ï¼Œé€šå¸¸ä»£è¡¨ä¸€ç»„è¡Œä¸ºæˆ–èŒè´£ã€‚è¿™äº›è¡Œä¸ºä¼šè½¬åŒ–ä¸ºï¼šè°å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œå“ªäº›è¡Œä¸ºï¼Ÿè°ä¸å¯ä»¥åœ¨ç¨‹åºä¸­æ‰§è¡Œå“ªäº›è¡Œä¸ºï¼Ÿ")]),t._v(" "),a("p",[t._v("è§’è‰²é€šå¸¸æ˜¯åˆ†é…ç»™ç”¨æˆ·å¸æˆ·çš„ï¼Œå› æ­¤é€šè¿‡å…³è”ï¼Œç”¨æˆ·å¯ä»¥è·å¾—è‡ªèº«è§’è‰²æ‰€èµ‹äºˆçš„æƒé™ã€‚")]),t._v(" "),a("h4",{attrs:{id:"ç”¨æˆ·"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨æˆ·"}},[t._v("#")]),t._v(" ç”¨æˆ·")]),t._v(" "),a("p",[t._v("ç”¨æˆ·æœ¬è´¨ä¸Šæ˜¯åº”ç”¨ç¨‹åºçš„â€œç”¨æˆ·â€ã€‚")]),t._v(" "),a("p",[t._v("ç”¨æˆ·ï¼ˆå³ Shiro çš„ "),a("code",[t._v("Subject")]),t._v("ï¼‰é€šè¿‡ä¸è§’è‰²æˆ–ç›´æ¥æƒé™çš„å…³è”åœ¨åº”ç”¨ç¨‹åºä¸­æ‰§è¡ŒæŸäº›è¡Œä¸ºã€‚")]),t._v(" "),a("h3",{attrs:{id:"åŸºäºè§’è‰²çš„æˆæƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäºè§’è‰²çš„æˆæƒ"}},[t._v("#")]),t._v(" åŸºäºè§’è‰²çš„æˆæƒ")]),t._v(" "),a("p",[t._v("å¦‚æœæˆæƒæ˜¯åŸºäºè§’è‰²èµ‹äºˆæƒé™çš„æ•°æ®æ¨¡å‹ï¼Œç¼–ç¨‹æ¨¡å¼å¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ä¸€ã€‘")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Subject currentUser = SecurityUtils.getSubject();\n\nif (currentUser.hasRole("administrator")) {\n    //show the admin button\n} else {\n    //don\'t show the button?  Grey it out?\n}\n')])])]),a("p",[t._v("ã€ç¤ºä¾‹äºŒã€‘")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('Subject currentUser = SecurityUtils.getSubject();\n\n// æ£€æŸ¥å½“å‰ Subject æ˜¯å¦æœ‰æŸç§æƒé™\n// å¦‚æœæœ‰ï¼Œç›´æ¥è·³è¿‡ï¼›å¦‚æœæ²¡æœ‰ï¼ŒShiro ä¼šæŠ›å‡º AuthorizationException\ncurrentUser.checkRole("bankTeller");\nopenBankAccount();\n')])])]),a("blockquote",[a("p",[t._v("æç¤ºï¼šæ–¹å¼äºŒç›¸æ¯”æ–¹å¼ä¸€ï¼Œä»£ç æ›´ç®€æ´")])]),t._v(" "),a("h3",{attrs:{id:"åŸºäºæƒé™çš„æˆæƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäºæƒé™çš„æˆæƒ"}},[t._v("#")]),t._v(" åŸºäºæƒé™çš„æˆæƒ")]),t._v(" "),a("p",[a("strong",[t._v("æ›´å¥½çš„æˆæƒç­–ç•¥é€šå¸¸æ˜¯åŸºäºæƒé™çš„æˆæƒ")]),t._v("ã€‚åŸºäºæƒé™çš„æˆæƒï¼Œç”±äºå®ƒå’Œåº”ç”¨ç¨‹åºçš„åŸå§‹åŠŸèƒ½ï¼ˆé’ˆå¯¹å…·ä½“èµ„æºä¸Šçš„è¡Œä¸ºï¼‰ç´§å¯†ç›¸å…³ï¼Œæ‰€ä»¥åŸºäºæƒé™çš„æˆæƒæºä»£ç ä¼šåœ¨åŠŸèƒ½æ›´æ”¹æ—¶åŒæ­¥æ›´æ”¹ï¼ˆè€Œä¸æ˜¯åœ¨å®‰å…¨ç­–ç•¥å‘ç”Ÿæ›´æ”¹æ—¶ï¼‰ã€‚ è¿™æ„å‘³ç€ä¸ç±»ä¼¼çš„åŸºäºè§’è‰²çš„æˆæƒä»£ç ç›¸æ¯”ï¼Œä¿®æ”¹ä»£ç çš„å½±å“é¢è¦å°å¾—å¤šã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘åŸºäºå¯¹è±¡çš„æƒé™æ£€æŸ¥")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Permission")]),t._v(" printPermission "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PrinterPermission")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"laserjet4400n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"print"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Subject")]),t._v(" currentUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecurityUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSubject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPermitted")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("printPermission"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//show the Print button")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//don't show the button?  Grey it out?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("åœ¨å¯¹è±¡ä¸­å­˜å‚¨æƒé™æ§åˆ¶ä¿¡æ¯ï¼Œä½†è¿™ç§æ–¹å¼è¾ƒä¸ºç¹é‡")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘å­—ç¬¦ä¸²å®šä¹‰æƒé™æ§åˆ¶ä¿¡æ¯")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Subject")]),t._v(" currentUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecurityUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSubject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isPermitted")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"printer:print:laserjet4400n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//show the Print button")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//don't show the button?  Grey it out?")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä½¿ç”¨ : åˆ†éš”ï¼Œè¡¨ç¤ºèµ„æºç±»å‹ã€è¡Œä¸ºã€èµ„æº IDï¼ŒShiro æä¾›äº†é»˜è®¤å®ç°ï¼š "),a("code",[t._v("org.apache.shiro.authz.permission.WildcardPermission")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("è¿™ç§æƒé™æ§åˆ¶æ–¹å¼çš„å¥½å¤„åœ¨äºï¼šè½»é‡ã€çµæ´»ã€‚")]),t._v(" "),a("h3",{attrs:{id:"åŸºäºæ³¨è§£çš„æˆæƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäºæ³¨è§£çš„æˆæƒ"}},[t._v("#")]),t._v(" åŸºäºæ³¨è§£çš„æˆæƒ")]),t._v(" "),a("p",[t._v("Shiro æä¾›äº†ä¸€äº›ç”¨äºæˆæƒçš„æ³¨è§£ï¼Œæ¥è¿›ä¸€æ­¥ç®€åŒ–æˆæƒä»£ç ã€‚")]),t._v(" "),a("h4",{attrs:{id:"requiresauthentication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requiresauthentication"}},[t._v("#")]),t._v(" "),a("code",[t._v("@RequiresAuthentication")])]),t._v(" "),a("p",[a("code",[t._v("@RequiresAuthentication")]),t._v(" æ³¨è§£è¦æ±‚å½“å‰ "),a("code",[t._v("Subject")]),t._v(" å¿…é¡»æ˜¯å·²è®¤è¯ç”¨æˆ·æ‰å¯ä»¥è®¿é—®è¢«ä¿®é¥°çš„æ–¹æ³•ã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RequiresAuthentication")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateAccount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Account")]),t._v(" userAccount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//this method will only be invoked by a")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Subject that is guaranteed authenticated")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"requiresguest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requiresguest"}},[t._v("#")]),t._v(" "),a("code",[t._v("@RequiresGuest")])]),t._v(" "),a("p",[a("code",[t._v("@RequiresGuest")]),t._v(" æ³¨è§£è¦æ±‚å½“å‰ "),a("code",[t._v("Subject")]),t._v(" çš„è§’è‰²æ˜¯ "),a("code",[t._v("guest")]),t._v(" æ‰å¯ä»¥è®¿é—®è¢«ä¿®é¥°çš„æ–¹æ³•ã€‚")]),t._v(" "),a("h3",{attrs:{id:"æˆæƒæµç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æˆæƒæµç¨‹"}},[t._v("#")]),t._v(" æˆæƒæµç¨‹")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/master/snap/20200317092618.png",alt:"img"}})]),t._v(" "),a("ol",[a("li",[a("p",[t._v("åº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ä»£ç è°ƒç”¨ä»»ä½• "),a("code",[t._v("Subject")]),t._v(" çš„ "),a("code",[t._v("hasRole*")]),t._v("ï¼Œ"),a("code",[t._v("checkRole*")]),t._v("ï¼Œ"),a("code",[t._v("isPermitted*")]),t._v(" æˆ– "),a("code",[t._v("checkPermission*")]),t._v(" æ–¹æ³•ï¼Œå¹¶ä¼ å…¥æ‰€éœ€çš„æƒé™æˆ–è§’è‰²ã€‚")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("Subject")]),t._v(" å®ä¾‹ï¼Œé€šå¸¸æ˜¯ "),a("code",[t._v("DelegatingSubject")]),t._v("ï¼ˆæˆ–å­ç±»ï¼‰ï¼Œé€šè¿‡è°ƒç”¨ "),a("code",[t._v("securityManager")]),t._v(" å‡ ä¹ç›¸åŒçš„å„è‡ª "),a("code",[t._v("hasRole*")]),t._v("ï¼Œ"),a("code",[t._v("checkRole*")]),t._v("ï¼Œ"),a("code",[t._v("isPermitted*")]),t._v(" æˆ– "),a("code",[t._v("checkPermission*")]),t._v(" æ–¹æ³•æ¥å§”æ‰˜ "),a("code",[t._v("SecurityManager")]),t._v(" ï¼ˆå®ç°äº† "),a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/authz/Authorizer.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("org.apache.shiro.authz.Authorizer")]),a("OutboundLink")],1),t._v(" æ¥å£ï¼‰å¤„ç†æˆæƒã€‚")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("SecurityManager")]),t._v(" é€šè¿‡è°ƒç”¨æˆæƒè€…å„è‡ªçš„ "),a("code",[t._v("hasRole*")]),t._v("ï¼Œ"),a("code",[t._v("checkRole*")]),t._v("ï¼Œ"),a("code",[t._v("isPermitted*")]),t._v(" æˆ– "),a("code",[t._v("checkPermission*")]),t._v(" æ–¹æ³•æ¥ä¸­ç»§/å§”æ‰˜å…¶å†…éƒ¨çš„ "),a("code",[t._v("org.apache.shiro.authz.Authorizer")]),t._v(" å®ä¾‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ"),a("code",[t._v("authorizer")]),t._v(" å®ä¾‹æ˜¯ "),a("code",[t._v("ModularRealmAuthorizer")]),t._v(" å®ä¾‹ï¼Œè¯¥å®ä¾‹æ”¯æŒåœ¨ä»»ä½•æˆæƒæ“ä½œæœŸé—´åè°ƒä¸€ä¸ªæˆ–å¤šä¸ª "),a("code",[t._v("Realm")]),t._v(" å®ä¾‹ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("æ£€æŸ¥æ¯ä¸ªå·²é…ç½®çš„ "),a("code",[t._v("Realm")]),t._v("ï¼Œä»¥æŸ¥çœ‹å…¶æ˜¯å¦å®ç°ç›¸åŒçš„ "),a("code",[t._v("Authorizer")]),t._v(" æ¥å£ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™å°†è°ƒç”¨ "),a("code",[t._v("Realm")]),t._v(" å„è‡ªçš„ "),a("code",[t._v("hasRole*")]),t._v("ï¼Œ"),a("code",[t._v("checkRole*")]),t._v("ï¼Œ"),a("code",[t._v("isPermitted*")]),t._v(" æˆ– "),a("code",[t._v("checkPermission*")]),t._v(" æ–¹æ³•ã€‚")])])]),t._v(" "),a("blockquote",[a("p",[t._v("ğŸ”— æ›´å¤šæˆæƒç»†èŠ‚å¯ä»¥å‚è€ƒï¼š"),a("a",{attrs:{href:"http://shiro.apache.org/authorization.html#apache-shiro-authorization",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache Shiro Authorization"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"å››ã€shiro-ä¼šè¯ç®¡ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€shiro-ä¼šè¯ç®¡ç†"}},[t._v("#")]),t._v(" å››ã€Shiro ä¼šè¯ç®¡ç†")]),t._v(" "),a("p",[t._v("Shiro æä¾›äº†ä¸€å¥—ç‹¬ç‰¹çš„ä¼šè¯ç®¡ç†æ–¹æ¡ˆï¼šå…¶ Session å¯ä»¥ä½¿ç”¨ Java SE ç¨‹åºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨äº Java Web ç¨‹åºã€‚")]),t._v(" "),a("p",[t._v("åœ¨ Shiro ä¸­ï¼Œ"),a("a",{attrs:{href:"http://shiro.apache.org/session-management.html#the-sessionmanager",target:"_blank",rel:"noopener noreferrer"}},[t._v("SessionManager"),a("OutboundLink")],1),t._v(" è´Ÿè´£ç®¡ç†åº”ç”¨æ‰€æœ‰ "),a("code",[t._v("Subject")]),t._v(" çš„ä¼šè¯ï¼Œå¦‚ï¼šåˆ›å»ºã€åˆ é™¤ã€å¤±æ•ˆã€éªŒè¯ç­‰ã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘ä¼šè¯ä½¿ç”¨ç¤ºä¾‹")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Subject")]),t._v(" currentUser "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecurityUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSubject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Session")]),t._v(" session "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" currentUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSession")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nsession"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttribute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"someKey"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" someValue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"ä¼šè¯è¶…æ—¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¼šè¯è¶…æ—¶"}},[t._v("#")]),t._v(" ä¼šè¯è¶…æ—¶")]),t._v(" "),a("p",[t._v("é»˜è®¤æƒ…å†µä¸‹ï¼ŒShiro ä¸­çš„ä¼šè¯æœ‰æ•ˆæœŸä¸º 30 åˆ†é’Ÿï¼Œè¶…æ—¶åï¼Œè¯¥ä¼šè¯å°†è¢« Shiro è§†ä¸ºæ— æ•ˆã€‚")]),t._v(" "),a("p",[t._v("å¯ä»¥é€šè¿‡ "),a("code",[t._v("globalSessionTimeout")]),t._v(" æ–¹æ³•è®¾ç½® Shiro ä¼šè¯è¶…æ—¶æ—¶é—´ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ä¼šè¯ç›‘å¬"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¼šè¯ç›‘å¬"}},[t._v("#")]),t._v(" ä¼šè¯ç›‘å¬")]),t._v(" "),a("p",[t._v("Shiro æä¾›äº† "),a("code",[t._v("SessionListener")]),t._v(" æ¥å£ï¼ˆæˆ– "),a("code",[t._v("SessionListenerAdapter")]),t._v(" æ¥å£ï¼‰ï¼Œç”¨äºç›‘å¬é‡è¦çš„ä¼šè¯äº‹ä»¶ï¼Œå¹¶å…è®¸ä½¿ç”¨è€…åœ¨äº‹ä»¶è§¦å‘æ—¶åšå®šåˆ¶åŒ–å¤„ç†ã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ShiroSessionListener")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SessionListener")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Logger")]),t._v(" log "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoggerFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLogger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),t._v(" sessionCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onStart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Session")]),t._v(" session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        sessionCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("incrementAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onStop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Session")]),t._v(" session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        sessionCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("decrementAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onExpiration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Session")]),t._v(" session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        sessionCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("decrementAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ä¼šè¯å­˜å‚¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¼šè¯å­˜å‚¨"}},[t._v("#")]),t._v(" ä¼šè¯å­˜å‚¨")]),t._v(" "),a("p",[t._v("å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”ç”¨éœ€è¦ä¿å­˜ä¼šè¯ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨ç¨åå¯ä»¥ä½¿ç”¨å®ƒã€‚")]),t._v(" "),a("p",[t._v("Shiro æä¾›äº† "),a("code",[t._v("SessionManager")]),t._v(" æ¥å£ï¼Œè´Ÿè´£å°†é’ˆå¯¹ä¼šè¯çš„ CRUD æ“ä½œå§”æ´¾ç»™å†…éƒ¨ç»„ä»¶ "),a("code",[t._v("SessionDAO")]),t._v("ï¼Œè¯¥ç»„ä»¶åæ˜ äº†æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰è®¾è®¡æ¨¡å¼ã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("ğŸ”” æ³¨æ„ï¼šç”±äºä¼šè¯é€šå¸¸å…·æœ‰æ—¶æ•ˆæ€§ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šè¯å¤©ç„¶é€‚åˆå­˜å‚¨äºç¼“å­˜ä¸­ã€‚å­˜å‚¨äº Redis ä¸­æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"äº”ã€realm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äº”ã€realm"}},[t._v("#")]),t._v(" äº”ã€Realm")]),t._v(" "),a("p",[a("code",[t._v("Realm")]),t._v(" æ˜¯ Shiro è®¿é—®ç¨‹åºå®‰å…¨ç›¸å…³æ•°æ®ï¼ˆå¦‚ï¼šç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰çš„æ¥å£ã€‚")]),t._v(" "),a("p",[a("code",[t._v("Realm")]),t._v(" æ˜¯æœ‰å¼€å‘è€…è‡ªå·±å®ç°çš„ï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡å®ç° Realm æ¥å£ï¼Œæ¥å…¥åº”ç”¨çš„æ•°æ®æºï¼Œå¦‚ï¼šJDBCã€æ–‡ä»¶ã€Nosql ç­‰ç­‰ã€‚")]),t._v(" "),a("h3",{attrs:{id:"è®¤è¯ä»¤ç‰Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¤è¯ä»¤ç‰Œ"}},[t._v("#")]),t._v(" è®¤è¯ä»¤ç‰Œ")]),t._v(" "),a("p",[t._v("Shiro æ”¯æŒèº«ä»½éªŒè¯ä»¤ç‰Œã€‚åœ¨å’¨è¯¢ Realm è¿›è¡Œè®¤è¯å°è¯•ä¹‹å‰ï¼Œå°†è°ƒç”¨å…¶æ”¯æŒæ–¹æ³•ã€‚ å¦‚æœè¿”å›å€¼ä¸º trueï¼Œåˆ™ä»…ä¼šè°ƒç”¨å…¶ "),a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/realm/Realm.html#getAuthenticationInfo-org.apache.shiro.authc.AuthenticationToken-",target:"_blank",rel:"noopener noreferrer"}},[t._v("getAuthenticationInfo(token)"),a("OutboundLink")],1),t._v(" æ–¹æ³•ã€‚é€šå¸¸ï¼ŒRealm ä¼šæ£€æŸ¥æ‰€æäº¤ä»¤ç‰Œçš„ç±»å‹ï¼ˆæ¥å£æˆ–ç±»ï¼‰ï¼Œä»¥æŸ¥çœ‹å…¶æ˜¯å¦å¯ä»¥å¤„ç†å®ƒã€‚")]),t._v(" "),a("p",[t._v("ä»¤ç‰Œè®¤è¯å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("æ£€æŸ¥ç”¨äºæ ‡è¯† principal çš„ä»¤ç‰Œï¼ˆå¸æˆ·æ ‡è¯†ä¿¡æ¯ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("æ ¹æ® principalï¼Œåœ¨æ•°æ®æºä¸­æŸ¥æ‰¾ç›¸åº”çš„å¸æˆ·æ•°æ®ã€‚")]),t._v(" "),a("li",[t._v("ç¡®ä¿ä»¤ç‰Œæä¾›çš„å‡­è¯ä¸æ•°æ®å­˜å‚¨ä¸­å­˜å‚¨çš„å‡­è¯åŒ¹é…ã€‚")]),t._v(" "),a("li",[t._v("å¦‚æœ credentials åŒ¹é…ï¼Œåˆ™è¿”å› "),a("code",[t._v("AuthenticationInfo")]),t._v(" å®ä¾‹ã€‚")]),t._v(" "),a("li",[t._v("å¦‚æœ credentials ä¸åŒ¹é…ï¼Œåˆ™æŠ›å‡º "),a("code",[t._v("AuthenticationException")]),t._v(" å¼‚å¸¸ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"åŠ å¯†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŠ å¯†"}},[t._v("#")]),t._v(" åŠ å¯†")]),t._v(" "),a("p",[t._v("é€šè¿‡å‰æ–‡ï¼Œå¯ä»¥äº†è§£ï¼šShiro éœ€è¦é€šè¿‡ä¸€å¯¹ principal å’Œ credentials æ¥ç¡®è®¤èº«ä»½æ˜¯å¦åŒ¹é…ï¼ˆå³è®¤è¯ï¼‰ã€‚")]),t._v(" "),a("p",[t._v("ä¸€èˆ¬æ¥è¯´ï¼Œæˆç†Ÿè½¯ä»¶æ˜¯ä¸å…è®¸å­˜å‚¨è´¦æˆ·ã€å¯†ç è¿™äº›æ•æ„Ÿæ•°æ®æ—¶ï¼Œä½¿ç”¨æ˜æ–‡å­˜å‚¨ã€‚æ‰€ä»¥ï¼Œé€šå¸¸è¦å°†å¯†ç åŠ å¯†åå­˜å‚¨ã€‚")]),t._v(" "),a("p",[t._v("Shiro æä¾›äº†ä¸€äº›åŠ å¯†å™¨ï¼Œå…¶æ€æƒ³å°±æ˜¯ç”¨ MD5ã€SHA è¿™ç§æ•°å­—ç­¾åç®—æ³•ï¼ŒåŠ  Saltï¼Œç„¶åè½¬ä¸º Base64 å­—ç¬¦ä¸²ã€‚ä¸ºäº†é¿å…è¢«æš´åŠ›ç ´è§£ï¼ŒShiro ä½¿ç”¨å¤šæ¬¡åŠ å¯†çš„æ–¹å¼è·å¾—æœ€ç»ˆçš„ credentials å­—ç¬¦ä¸²ã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘Shiro åŠ å¯†å¯†ç ç¤ºä¾‹")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shiro"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("crypto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Sha256Hash")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shiro"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("crypto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RandomNumberGenerator")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token import"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shiro"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("crypto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecureRandomNumberGenerator")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//We'll use a Random Number Generator to generate salts.  This")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//is much more secure than using a username as a salt or not")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//having a salt at all.  Shiro makes this easy.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Note that a normal app would reference an attribute rather")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//than create a new RNG every time:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RandomNumberGenerator")]),t._v(" rng "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecureRandomNumberGenerator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" salt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rng"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Now hash the plain-text password with the random salt and multiple")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//iterations and then Base64-encode the value (requires less space than Hex):")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" hashedPasswordBase64 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Sha256Hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("plainTextPassword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" salt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toBase64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" hashedPasswordBase64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//save the salt with the new account.  The HashedCredentialsMatcher")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//will need it later when handling login attempts:")]),t._v("\nuser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPasswordSalt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("salt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nuserDAO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"å…­ã€é…ç½®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…­ã€é…ç½®"}},[t._v("#")]),t._v(" å…­ã€é…ç½®")]),t._v(" "),a("h3",{attrs:{id:"è¿‡æ»¤é“¾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¿‡æ»¤é“¾"}},[t._v("#")]),t._v(" è¿‡æ»¤é“¾")]),t._v(" "),a("p",[t._v("è¿è¡Œ Web åº”ç”¨ç¨‹åºæ—¶ï¼ŒShiro å°†åˆ›å»ºä¸€äº›æœ‰ç”¨çš„é»˜è®¤ Filter å®ä¾‹ã€‚")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("Filter Name")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("Class")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("anon")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authc/AnonymousFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authc.AnonymousFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("authc")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authc/FormAuthenticationFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authc.FormAuthenticationFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("authcBasic")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authc/BasicHttpAuthenticationFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authc.BasicHttpAuthenticationFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("logout")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authc/LogoutFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authc.LogoutFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("noSessionCreation")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/session/NoSessionCreationFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.session.NoSessionCreationFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("perms")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authz/PermissionsAuthorizationFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("port")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authz/PortFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authz.PortFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("rest")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authz/HttpMethodPermissionFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authz.HttpMethodPermissionFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("roles")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authz/RolesAuthorizationFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authz.RolesAuthorizationFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("ssl")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authz/SslFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authz.SslFilter"),a("OutboundLink")],1)])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("user")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[a("a",{attrs:{href:"http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/authc/UserFilter.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("org.apache.shiro.web.filter.authc.UserFilter"),a("OutboundLink")],1)])])])]),t._v(" "),a("h3",{attrs:{id:"rememberme"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rememberme"}},[t._v("#")]),t._v(" RememberMe")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsernamePasswordToken")]),t._v(" token "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UsernamePasswordToken")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ntoken"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRememberMe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SecurityUtils")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSubject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("login")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("token"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[t._v("#")]),t._v(" å‚è€ƒèµ„æ–™")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://shiro.apache.org/reference.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Shiro å®˜æ–¹æ–‡æ¡£"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"http://jinnianshilongnian.iteye.com/category/305053",target:"_blank",rel:"noopener noreferrer"}},[t._v("è·Ÿæˆ‘å­¦ Shiro"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://stormpath.com/blog/new-rbac-resource-based-access-control",target:"_blank",rel:"noopener noreferrer"}},[t._v("The New RBAC: Resource-Based Access Control"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);