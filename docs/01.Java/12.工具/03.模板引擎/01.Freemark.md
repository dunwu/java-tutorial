---
title: Freemark å¿«é€Ÿå…¥é—¨
date: 2022-02-17 22:34:30
order: 01
categories:
  - Java
  - å·¥å…·
  - æ¨¡æ¿å¼•æ“
tags:
  - Java
  - æ¨¡æ¿å¼•æ“
  - Freemark
permalink: /pages/a60ccf/
---

# Freemark å¿«é€Ÿå…¥é—¨

> FreeMarker æ˜¯ä¸€æ¬¾æ¨¡æ¿å¼•æ“ï¼š å³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œ å¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬(HTML ç½‘é¡µï¼Œç”µå­é‚®ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼Œæºä»£ç ç­‰)çš„é€šç”¨å·¥å…·ã€‚ å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ª Java ç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚

## Freemark ç®€ä»‹

Freemark æ¨¡æ¿ç¼–å†™ä¸º FreeMarker Template Language (FTL)ã€‚å®ƒæ˜¯ç®€å•çš„ï¼Œä¸“ç”¨çš„è¯­è¨€ï¼Œ _ä¸æ˜¯_ åƒ PHP é‚£æ ·æˆç†Ÿçš„ç¼–ç¨‹è¯­è¨€ã€‚åœ¨æ¨¡æ¿ä¸­ï¼Œä½ å¯ä»¥ä¸“æ³¨äºå¦‚ä½•å±•ç°æ•°æ®ï¼Œ è€Œåœ¨æ¨¡æ¿ä¹‹å¤–å¯ä»¥ä¸“æ³¨äºè¦å±•ç¤ºä»€ä¹ˆæ•°æ®ã€‚

![img](http://freemarker.foofun.cn/figures/overview.png)

è¿™ç§æ–¹å¼é€šå¸¸è¢«ç§°ä¸º [MVC (æ¨¡å‹ è§†å›¾ æ§åˆ¶å™¨) æ¨¡å¼](http://freemarker.foofun.cn/gloss.html#gloss.MVC)ï¼Œå¯¹äºåŠ¨æ€ç½‘é¡µæ¥è¯´ï¼Œæ˜¯ä¸€ç§ç‰¹åˆ«æµè¡Œçš„æ¨¡å¼ã€‚ å®ƒå¸®åŠ©ä»å¼€å‘äººå‘˜(Java ç¨‹åºå‘˜)ä¸­åˆ†ç¦»å‡ºç½‘é¡µè®¾è®¡å¸ˆ(HTML è®¾è®¡å¸ˆ)ã€‚è®¾è®¡å¸ˆæ— éœ€é¢å¯¹æ¨¡æ¿ä¸­çš„å¤æ‚é€»è¾‘ï¼Œ åœ¨æ²¡æœ‰ç¨‹åºå‘˜æ¥ä¿®æ”¹æˆ–é‡æ–°ç¼–è¯‘ä»£ç æ—¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹é¡µé¢çš„æ ·å¼ã€‚

Freemark æ¨¡æ¿ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š**_`æ¨¡æ¿ + æ•°æ®æ¨¡å‹ = è¾“å‡º`_**

## æ€»ä½“ç»“æ„

- **æ–‡æœ¬**ï¼šæ–‡æœ¬ä¼šç…§ç€åŸæ ·æ¥è¾“å‡ºã€‚
- **æ’å€¼**ï¼šè¿™éƒ¨åˆ†çš„è¾“å‡ºä¼šè¢«è®¡ç®—çš„å€¼æ¥æ›¿æ¢ã€‚æ’å€¼ç”± `${` and `}` æ‰€åˆ†éš”(æˆ–è€… `#{` and `}`ï¼Œè¿™ç§é£æ ¼å·²ç»ä¸å»ºè®®å†ä½¿ç”¨äº†ï¼›[ç‚¹å‡»æŸ¥çœ‹æ›´å¤š](http://freemarker.foofun.cn/ref_depr_numerical_interpolation.html))ã€‚
- **FTL æ ‡ç­¾**ï¼šFTL æ ‡ç­¾å’Œ HTML æ ‡ç­¾å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬å´æ˜¯ç»™ FreeMarker çš„æŒ‡ç¤ºï¼Œ è€Œä¸”ä¸ä¼šæ‰“å°åœ¨è¾“å‡ºå†…å®¹ä¸­ã€‚
- **æ³¨é‡Š**ï¼šæ³¨é‡Šå’Œ HTML çš„æ³¨é‡Šä¹Ÿå¾ˆç›¸ä¼¼ï¼Œä½†å®ƒä»¬æ˜¯ç”± `<#--` å’Œ `-->`æ¥åˆ†éš”çš„ã€‚æ³¨é‡Šä¼šè¢« FreeMarker ç›´æ¥å¿½ç•¥ï¼Œ æ›´ä¸ä¼šåœ¨è¾“å‡ºå†…å®¹ä¸­æ˜¾ç¤ºã€‚

![img](https://raw.githubusercontent.com/dunwu/images/master/snap/ftl-template.png)

> ğŸ”” æ³¨æ„ï¼š
>
> - FTL æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚
> - `æ’å€¼` ä»…ä»…å¯ä»¥åœ¨ `æ–‡æœ¬` ä¸­ä½¿ç”¨ã€‚
> - `FTL æ ‡ç­¾` ä¸å¯ä»¥åœ¨å…¶ä»– `FTL æ ‡ç­¾` å’Œ `æ’å€¼` ä¸­ä½¿ç”¨ã€‚
> - `æ³¨é‡Š` å¯ä»¥æ”¾åœ¨ `FTL æ ‡ç­¾` å’Œ `æ’å€¼` ä¸­ã€‚

### æŒ‡ä»¤

FTL æŒ‡ä»¤æœ‰ä¸¤ç§ç±»å‹ï¼š [é¢„å®šä¹‰æŒ‡ä»¤](http://freemarker.foofun.cn/gloss.html#gloss.predefinedDirective) å’Œ [ç”¨æˆ·è‡ªå®šä¹‰æŒ‡ä»¤](http://freemarker.foofun.cn/gloss.html#gloss.userDefinedDirective)ã€‚ å¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„æŒ‡ä»¤ä½¿ç”¨ `@` æ¥ä»£æ›¿ `#`ã€‚

> ğŸ”” æ³¨æ„ï¼š
>
> - FreeMarker ä»…ä»…å…³å¿ƒ FTL æ ‡ç­¾çš„åµŒå¥—è€Œä¸å…³å¿ƒ HTML æ ‡ç­¾çš„åµŒå¥—ã€‚ å®ƒåªä¼šæŠŠ HTML çœ‹åšæ˜¯æ–‡æœ¬ï¼Œä¸ä¼šæ¥è§£é‡Š HTMLã€‚
> - å¦‚æœä½ å°è¯•ä½¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æŒ‡ä»¤(æ¯”å¦‚ï¼Œè¾“é”™äº†æŒ‡ä»¤çš„åç§°)ï¼Œ FreeMarker å°±ä¼šæ‹’ç»æ‰§è¡Œæ¨¡æ¿ï¼ŒåŒæ—¶æŠ›å‡ºé”™è¯¯ä¿¡æ¯ã€‚
> - FreeMarker ä¼šå¿½ç•¥ FTL æ ‡ç­¾ä¸­å¤šä½™çš„ [ç©ºç™½æ ‡è®°](http://freemarker.foofun.cn/gloss.html#gloss.whiteSpace)ã€‚

### è¡¨è¾¾å¼

ä»¥ä¸‹ä¸ºå¿«é€Ÿæµè§ˆæ¸…å•ï¼Œå¦‚æœéœ€è¦äº†è§£æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è€ƒ[**è¿™é‡Œ**](http://freemarker.foofun.cn/dgui_template_exp.html)ã€‚

- [ç›´æ¥æŒ‡å®šå€¼](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct)
  - [å­—ç¬¦ä¸²](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_string)ï¼š `"Foo"` æˆ–è€… `'Foo'` æˆ–è€… `"It's \"quoted\""` æˆ–è€… `'It\'s "quoted"'` æˆ–è€… `r"C:\raw\string"`
  - [æ•°å­—](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_number)ï¼š `123.45`
  - [å¸ƒå°”å€¼](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_boolean)ï¼š `true`ï¼Œ `false`
  - [åºåˆ—](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_seuqence)ï¼š `["foo", "bar", 123.45]`ï¼› å€¼åŸŸï¼š `0..9`, `0..<10` (æˆ– `0..!10`), `0..`
  - [å“ˆå¸Œè¡¨](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_hash)ï¼š `{"name":"green mouse", "price":150}`
- [æ£€ç´¢å˜é‡](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var)
  - [é¡¶å±‚å˜é‡](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_toplevel)ï¼š `user`
  - [ä»å“ˆå¸Œè¡¨ä¸­æ£€ç´¢æ•°æ®](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_hash)ï¼š `user.name`ï¼Œ `user["name"]`
  - [ä»åºåˆ—ä¸­æ£€ç´¢æ•°æ®](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_sequence)ï¼š `products[5]`
  - [ç‰¹æ®Šå˜é‡](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_var_special)ï¼š `.main`
- [å­—ç¬¦ä¸²æ“ä½œ](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_stringop)
  - [æ’å€¼(æˆ–è¿æ¥)](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_stringop_interpolation)ï¼š `"Hello ${user}!"` (æˆ– `"Hello " + user + "!"`)
  - [è·å–ä¸€ä¸ªå­—ç¬¦](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_get_character)ï¼š `name[0]`
  - [å­—ç¬¦ä¸²åˆ‡åˆ†ï¼š](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_stringop_slice) åŒ…å«ç»“å°¾ï¼š `name[0..4]`ï¼Œä¸åŒ…å«ç»“å°¾ï¼š `name[0..<5]`ï¼ŒåŸºäºé•¿åº¦(å®½å®¹å¤„ç†)ï¼š `name[0..*5]`ï¼Œå»é™¤å¼€å¤´ï¼š`name[5..]`
- [åºåˆ—æ“ä½œ](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_sequenceop)
  - [è¿æ¥](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_sequenceop_cat)ï¼š `users + ["guest"]`
  - [åºåˆ—åˆ‡åˆ†](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_seqenceop_slice)ï¼šåŒ…å«ç»“å°¾ï¼š `products[20..29]`ï¼Œ ä¸åŒ…å«ç»“å°¾ï¼š `products[20..<30]`ï¼ŒåŸºäºé•¿åº¦(å®½å®¹å¤„ç†)ï¼š`products[20..*10]`ï¼Œå»é™¤å¼€å¤´ï¼š `products[20..]`
- [å“ˆå¸Œè¡¨æ“ä½œ](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_hashop)
  - [è¿æ¥](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_hashop_cat)ï¼š `passwords + { "joe": "secret42" }`
- [ç®—æœ¯è¿ç®—](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_arit)ï¼š `(x * 1.5 + 10) / 2 - y % 100`
- [æ¯”è¾ƒè¿ç®—](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_comparison)ï¼š `x == y`ï¼Œ `x != y`ï¼Œ `x < y`ï¼Œ `x > y`ï¼Œ `x >= y`ï¼Œ `x <= y`ï¼Œ `x lt y`ï¼Œ `x lte y`ï¼Œ `x gt y`ï¼Œ `x gte y`ï¼Œ ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
- [é€»è¾‘æ“ä½œ](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_logicalop)ï¼š `!registered && (firstVisit || fromEurope)`
- [å†…å»ºå‡½æ•°](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_builtin)ï¼š `name?upper_case`, `path?ensure_starts_with('/')`
- [æ–¹æ³•è°ƒç”¨](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_methodcall)ï¼š `repeat("What", 3)`
- [å¤„ç†ä¸å­˜åœ¨çš„å€¼](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_missing)
  - [é»˜è®¤å€¼](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_missing_default)ï¼š `name!"unknown"` æˆ–è€… `(user.name)!"unknown"` æˆ–è€… `name!` æˆ–è€… `(user.name)!`
  - [æ£€æµ‹ä¸å­˜åœ¨çš„å€¼](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_missing_test)ï¼š `name??` æˆ–è€… `(user.name)??`
- [èµ‹å€¼æ“ä½œ](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_assignment)ï¼š `=`, `+=`, `-=`, `*=`, `/=`, `%=`, `++`, `--`

### å˜é‡

æ³¨æ„ï¼šå˜é‡ _ä»…ä»…_ åœ¨ [æ–‡æœ¬åŒº](http://freemarker.foofun.cn/dgui_template_overallstructure.html) (æ¯”å¦‚ `<h1>Hello ${name}!</h1>`) å’Œ [å­—ç¬¦ä¸²](http://freemarker.foofun.cn/dgui_template_exp.html#dgui_template_exp_direct_string) ä¸­èµ·ä½œç”¨ã€‚

æ­£ç¡®ç¤ºä¾‹ï¼š

```
<#include "/footer/${company}.html">
<#if big>...</#if>
```

é”™è¯¯ç¤ºä¾‹ï¼š

```
<#if ${big}>...</#if>
<#if "${big}">...</#if>
```

## æ•°æ®ç±»å‹

Freemark æ”¯æŒçš„ç±»å‹æœ‰ï¼š

### æ ‡é‡

å­—ç¬¦ä¸²

```
${"Hello ${user}"}
${"I can escape with \\ ${user}"}
${r"Now I can read dollar signs $"}
```

è¾“å‡ºï¼š

```
Hello deister
I can escape with \ deister
Now I can read dollar signs $
```

æ•°å­—

å¸ƒå°”å€¼

æ—¥æœŸ/æ—¶é—´ (æ—¥æœŸï¼Œæ—¶é—´æˆ–æ—¥æœŸæ—¶é—´)

### å®¹å™¨

- å“ˆå¸Œè¡¨
- åºåˆ—
- é›†åˆ

### å­ç¨‹åº

- [æ–¹æ³•å’Œå‡½æ•°](http://freemarker.foofun.cn/dgui_datamodel_types.html#dgui_datamodel_method)
- [ç”¨æˆ·è‡ªå®šä¹‰æŒ‡ä»¤](http://freemarker.foofun.cn/dgui_datamodel_types.html#dgui_datamodel_userdefdir)

### å…¶å®ƒ

- [ç»“ç‚¹](http://freemarker.foofun.cn/dgui_datamodel_types.html#dgui_datamodel_node)

## è½¬ä¹‰ç¬¦

FTL æ”¯æŒçš„æ‰€æœ‰è½¬ä¹‰å­—ç¬¦ï¼š

| è½¬ä¹‰åºåˆ— | å«ä¹‰                                                                                                                                           |
| :------- | :--------------------------------------------------------------------------------------------------------------------------------------------- |
| `\"`     | å¼•å· (u0022)                                                                                                                                   |
| `\'`     | å•å¼•å·(åˆç§°ä¸ºæ’‡å·) (u0027)                                                                                                                     |
| `\{`     | èµ·å§‹èŠ±æ‹¬å·ï¼š`{`                                                                                                                                |
| `\\`     | åæ–œæ  (u005C)                                                                                                                                 |
| `\n`     | æ¢è¡Œç¬¦ (u000A)                                                                                                                                 |
| `\r`     | å›è½¦ (u000D)                                                                                                                                   |
| `\t`     | æ°´å¹³åˆ¶è¡¨ç¬¦(åˆç§°ä¸º tab) (u0009)                                                                                                                 |
| `\b`     | é€€æ ¼ (u0008)                                                                                                                                   |
| `\f`     | æ¢é¡µ (u000C)                                                                                                                                   |
| `\l`     | å°äºå·ï¼š`<`                                                                                                                                    |
| `\g`     | å¤§äºå·ï¼š`>`                                                                                                                                    |
| `\a`     | &ç¬¦ï¼š`&`                                                                                                                                       |
| `\xCode` | å­—ç¬¦çš„ 16 è¿›åˆ¶ [Unicode](http://freemarker.foofun.cn/gloss.html#gloss.unicode) ç  ([UCS](http://freemarker.foofun.cn/gloss.html#gloss.UCS) ç ) |

## å‚è€ƒèµ„æ–™

- [Freemark Github](https://github.com/apache/freemarker)
- [Freemark ä¸­æ–‡æ•™ç¨‹](http://freemarker.foofun.cn/)
- [åœ¨çº¿ Freemark å·¥å…·](https://try.freemarker.apache.org/)